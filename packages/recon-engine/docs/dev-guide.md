recon-engine Developer Guide
============================

As much help as we can cram into a md file to get you going developing Recon.

Please also refer to our top-level [Developer Guide](../../../docs/dev-guide.md) if you haven't already!

## How do we come up with our data?

1. Discover
2. Parse and extract
2. Query and resolve

#### 1. Discover

The simplest way to build up a dependency and usage graph is to find and parse all
modules in a codebase. The user can direct on where in their file system they want
us to search.

#### 2. Parse and extract

We then, on an individual module basis, traverse and extract
any information we can find to be potentially useful for querying later. This is
basically taking the user's source code, identifying the pieces we want to query and
then structuring it in the optimal way for search/traversal.

i. Parse each module individually looking for *top level* symbols. Resolve each symbol
to it's local definition.
ii. Are any of these symbols components? Let's extract *whatever* useful info we can
(and resolve references upto the module boundary).
iii. Return "module" (containing root symbol table and corresponding component info)
for it to be stored in global list.

#### 3. Query and resolve

i. Queries (Graphql) come in and we can traverse our parsed modules to fulfil.
ii. As we are resolving references (mainly component usage) we can collect any useful
information along the way (eg. "enhancements")

> Note: Immutability helps this to be heavily optimised (memoizing)

## So what does that mean if there's something I want to fix?

Well...

- If Recon is struggling to extract component definitions in your module look in `src/parse`
- If Recon is failing to connect the dots when you query components look in `src/query`

## Useful resources

- [ASTExplorer](http://astexplorer.net) - Wonderful tool for easily inspecting your code's AST
- [babel-handbook](https://github.com/thejameskyle/babel-handbook) (the plugin section) -
If you want to touch `src/parse` this will get you up to speed with how to efficiently
traverse the ast generated by babel.

## Hints

- Use NODE_DEBUG=tmatch to get extra helpful output when debugging tests where
`expect().toMatch()` is failing.
